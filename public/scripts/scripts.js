"use strict";angular.module("panicApp",["panicApp.Controllers","panicApp.referenceDataServices","panicApp.designBuildDirectives","ui.bootstrap","analytics"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"views/home.html",controller:"StaticPageCtrl"}).when("/fabrics",{templateUrl:"views/fabrics.html",controller:"StaticPageCtrl"}).when("/party",{templateUrl:"views/party.html",controller:"StaticPageCtrl"}).when("/contact",{templateUrl:"views/contact.html",controller:"StaticPageCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"StaticPageCtrl"}).when("/collection",{templateUrl:"views/dressCollection.html",controller:"DressCollectionCtrl"}).when("/design",{templateUrl:"views/silhouettes.html",controller:"SilhouetteCtrl"}).when("/design/:rangeId",{templateUrl:"views/designBuild.html",controller:"DesignBuildCtrl"}).when("/design/:rangeId/:itemId",{templateUrl:"views/designBuild.html",controller:"DesignBuildCtrl"}).when("/newdesign/:rangeId",{templateUrl:"views/newDesignBuild.html",controller:"NewDesignBuildCtrl"}).when("/newdesign/:rangeId/:itemId",{templateUrl:"views/newDesignBuild.html",controller:"NewDesignBuildCtrl"}).when("/purchase",{templateUrl:"views/purchase.html",controller:"PurchaseCtrl"}).when("/adminCollection",{templateUrl:"views/adminCollection.html",controller:"CollectionCtrl"}).when("/adminCollection/:rangeId",{templateUrl:"views/adminRangeDetails.html",controller:"RangeDetailsCtrl"}).otherwise({redirectTo:"/"})}]),function(){for(var e,n=function(){},o=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],t=o.length,l=window.console=window.console||{};t--;)e=o[t],l[e]||(l[e]=n)}();var _gaq=_gaq||[];angular.module("analytics",[]).run(["$http",function(){console.log("run analytics"),_gaq.push(["_setAccount","UA-38964974-1"]),_gaq.push(["_setDomainName","none"]);var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}]).service("analytics",function(e,n,o,t){e.$on("$viewContentLoaded",l),console.log("analytics service");var l=function(){console.log("in track");var e=a(o.path(),t);n._gaq.push(["_trackPageview",e])},a=function(e,n){for(var o in n){var t="/"+n[o];e=e.replace(t,"")}var l=decodeURIComponent($.param(n));return""===l?e:e+"?"+l}});var referenceDataServices=angular.module("panicApp.referenceDataServices",["ngResource"]);referenceDataServices.factory("Range",["$resource",function(e){return e("referenceData/:rangeId.json",{},{designCatalogue:{method:"GET",params:{rangeId:"designCatalogue"},isArray:!0},itemCollection:{method:"GET",params:{rangeId:"itemCollection"},isArray:!0},labelLookup:{method:"GET",params:{rangeId:"labels"},isArray:!0}})}]).factory("DesignBuilder",["$resource",function(e){return e("referenceData/designBuilder/:fileId.json",{},{options:{method:"GET",params:{fileId:"options"},isArray:!0},fabricSets:{method:"GET",params:{fileId:"fabricSets"},isArray:!0}})}]).service("ReferenceDataCache",["Range","DesignBuilder",function(e,n){var o=null,t=null,l=null,a=null;return{getDesignCatalogue:function(){return null==o&&(o=e.designCatalogue(),console.log("Lazy instantiation of designCatalogue:"+o.length)),o},getLabels:function(){return console.log("getLabels"),null==t&&(t=e.labelLookup(),console.log("Lazy instantiation of labelCache:"+t.length)),t},getOptions:function(){return console.log("getOptions"),null==l&&(l=n.options(),console.log("Lazy instantiation of optionCache:"+l.length)),l},getItemCollection:function(){return null==a&&(a=e.itemCollection(function(e){console.log("----Lazy instantiation of itemCollection: "+e.length)},function(e){console.log("Oops -failed to instantiate itemCollection: "+e.length)})),a},getItemDesign:function(e){var n={},o="";return n=this.getItemCollection(function(){console.log("Looking up item: "+e),console.log("item.length: "+n.length);for(var t=0;n.length>t;t++)if(console.log("-Checking item: "+n[t].itemId),n[t].itemId===e){console.log("---Found item: "+e+" -> "+n[t].design),o=angular.copy(n[t].design);break}},function(e){console.log("Oops -failed to getItemColection: "+e.length)}),o}}}]).filter("fabricLookup",["ReferenceDataCache",function(e){return function(n){var o=e.getOptions(),t="";console.log("Looking up fabric: "+n),console.log("options.length: "+o.length);for(var l=0;o.length>l;l++)if(o[l].id===n){console.log("**Found options: "+n+" -> "+o[l].fabrics),t=angular.copy(o[l].fabrics);break}return t}}]).filter("trimLookup",["ReferenceDataCache",function(e){return function(n){var o=e.getOptions(),t="";console.log("Looking up trim: "+n),console.log("options.length: "+o.length);for(var l=0;o.length>l;l++)if(o[l].id===n){console.log("***********Found trim: "+n+" -> "+o[l].trims),t=angular.copy(o[l].trims);break}return t}}]).filter("labelLookup",["ReferenceDataCache",function(e){return function(n){var o=e.getLabels(),t="";console.log("Looking up label: "+n),console.log("label.length: "+o.length);for(var l=0;o.length>l;l++)o[l].id===n&&(console.log("Found label: "+n+" -> "+o[l].label),t=angular.copy(o[l].label));return t}}]);var designBuildDirectives=angular.module("panicApp.designBuildDirectives",[]);designBuildDirectives.directive("fabrics",function(){return{scope:{selection:"=",selectedOption:"="},template:'<button ng-repeat="fabric in selection" type="button" class="btn selector option fabric{{fabric.fabId}}" ng-model="selectedOption[\'fabric\']" btn-radio="fabric"></button>'}}),designBuildDirectives.directive("drawDress",function(){return{scope:{dress:"="},template:'<img ng-repeat="selection in dress" ng-src="images/parts/{{selection.type}}-{{selection.id}}-{{selection.fabric}}.png" class="pic {{selection.type}}"/>'}}),designBuildDirectives.directive("drawFabrics",function(){return{scope:{selection:"=",selectedOption:"="},template:"<button ng-repeat=\"fabric in selection\" type=\"button\" class=\"btn selector option fabric{{fabric.fabId}}\" ng-model=\"selectedOption['fabric']\" btn-radio=\"fabric.fabId\" onClick=\"_gaq.push(['_trackEvent', 'Design Build', 'select fabric', '{{selectedOption.type}}-{{selectedOption.id}}', '{{fabric.fabId}}' ]);\"></button>"}}),angular.module("panicApp.Controllers",[]).run(["$http",function(){console.log("run analytics"),_gaq.push(["_setAccount","UA-38964974-1"]),_gaq.push(["_setDomainName","none"]);var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)}]);var trackPageInGoogleAnalytics=function(){},track=function(e,n,o){var t=convertPathToQueryString(n.path(),o);console.log("track: about to push: "+t),e._gaq.push(["_trackPageview",t])},convertPathToQueryString=function(e,n){for(var o in n){var t="/"+n[o];e=e.replace(t,"")}var l=decodeURIComponent($.param(n));return""===l?e:e+"?"+l};angular.module("panicApp.Controllers").controller("HomeCarouselCtrl",["$scope",function(e){e.myInterval=5e3,e.slides=[{image:"images/kitten1.jpeg",text:"Kitten."},{image:"images/kitten2.jpeg",text:"Kitty!"},{image:"images/kitten3.jpeg",text:"Cat."}]}]),angular.module("panicApp.Controllers").controller("StaticPageCtrl",["$rootScope","$window","$location","$routeParams",function(e,n,o,t){trackPageInGoogleAnalytics(e,n,o,t)}]),angular.module("panicApp.Controllers").controller("DressCollectionCtrl",["$scope","Range","$rootScope","$window","$location","$routeParams",function(e,n,o,t,l,a){trackPageInGoogleAnalytics(o,t,l,a),e.dresses=n.itemCollection()}]),angular.module("panicApp.Controllers").controller("SilhouetteCtrl",["$scope","Range","$rootScope","$window","$location","$routeParams",function(e,n,o,t,l,a){trackPageInGoogleAnalytics(o,t,l,a),e.silhouettes=n.designCatalogue()}]),angular.module("panicApp.Controllers").controller("RangeDetailsCtrl",["$scope","$routeParams","Range","$rootScope","$window","$location",function(e,n,o,t,l,a){t.$on("$viewContentLoaded",track(l,a,n)),e.ranges=o.query(),e.range=o.get({rangeId:n.rangeId})}]),angular.module("panicApp.Controllers").controller("DesignBuildCtrl",["$scope","$routeParams","Range","ReferenceDataCache","DesignBuilder","$rootScope","$window","$location",function(e,n,o,t,l,a,r,i){trackPageInGoogleAnalytics(a,r,i,n);var c="",s="dresses",g=n.rangeId,u=n.itemId;e.designId=g,e.categoryId=s,u&&o.itemCollection(function(e){console.log("Looking up item: "+u),console.log("itemData.length: "+e.length);for(var n=0;e.length>n;n++)if(console.log("-Checking item: "+e[n].itemId),e[n].itemId===u){console.log("---Found item: "+u+" -> "+e[n].design),c=angular.copy(e[n].design);break}},function(e){console.log("Oops - failed to getItemColection: "+e.length)}),e.ranges=o.designCatalogue(function(){console.log("=================="),loadDesign(e)}),e.range=l.get({fileId:n.rangeId},function(n){u||(c=angular.copy(n.default)),e.master=c,e.cancel()},function(){alert("ooops")}),e.cancel=function(){e.form=angular.copy(c)},e.updateFabrics=function(){e.form},e.save=function(){c=e.form,e.cancel()},e.isCancelDisabled=function(){return angular.equals(c,e.form)}}]);var loadDesign=function(e){var n=getCategoryById(e.ranges,e.categoryId),o=getDesignById(n.designs,e.designId);e.category=n,e.design=o},getCategoryById=function(e,n){console.log("categories.length"+e.length);for(var o=[],t=0;e.length>t;t++)console.log("categoryName"+e[t].catId),e[t].catId===n&&(console.log("Found category: "+n+" -> "+e[t].catId),o=angular.copy(e[t]));return console.log("Returning: "+o),o},getDesignById=function(e,n){console.log("designs.length: "+e.length);for(var o={},t=0;e.length>t;t++)console.log("id: "+e[t].desId),e[t].desId===n&&(console.log("Found category: "+n+" -> "+e[t].desId),o=angular.copy(e[t]));return console.log("Returning: "+o),o};angular.module("panicApp.Controllers").controller("NewDesignBuildCtrl",["$scope","$routeParams","Range","ReferenceDataCache","DesignBuilder","$rootScope","$window","$location",function(e,n,o,t,l,a,r,i){trackPageInGoogleAnalytics(a,r,i,n);var c="",s="dresses",g=n.rangeId,u=n.itemId,d={},p={};e.designId=g,e.categoryId=s,u&&o.itemCollection(function(e){console.log("Looking up item: "+u),console.log("itemData.length: "+e.length);for(var n=0;e.length>n;n++)if(console.log("-Checking item: "+e[n].itemId),e[n].itemId===u){console.log("---Found item: "+u+" -> "+e[n].design),c=angular.copy(e[n].design);break}},function(e){console.log("Oops - failed to getItemColection: "+e.length)}),e.ranges=o.designCatalogue(function(){console.log("=================="),loadDesign(e)}),e.range=l.get({fileId:n.rangeId},function(n){u||(c=angular.copy(n.default)),p=angular.copy(n),e.master=c,e.cancel()},function(){alert("ooops - loading range")}),e.cancel=function(){e.form=angular.copy(c)},e.fabricSets=l.fabricSets(function(n){d=angular.copy(n);for(var o in p.options)for(var t in p.options[o].fabricSets)for(var l in d)if(p.options[o].fabricSets[t].set==d[l].setId){e.range.options[o].fabricSets[t]=d[l];break}},function(){alert("ooops - loading fabrics")}),e.save=function(){c=e.form,e.cancel()},e.isCancelDisabled=function(){return angular.equals(c,e.form)}}]);var loadDesign=function(e){var n=getCategoryById(e.ranges,e.categoryId),o=getDesignById(n.designs,e.designId);e.category=n,e.design=o},getCategoryById=function(e,n){console.log("categories.length"+e.length);for(var o=[],t=0;e.length>t;t++)console.log("categoryName"+e[t].catId),e[t].catId===n&&(console.log("Found category: "+n+" -> "+e[t].catId),o=angular.copy(e[t]));return console.log("Returning: "+o),o},getDesignById=function(e,n){console.log("designs.length: "+e.length);for(var o={},t=0;e.length>t;t++)console.log("id: "+e[t].desId),e[t].desId===n&&(console.log("Found category: "+n+" -> "+e[t].desId),o=angular.copy(e[t]));return console.log("Returning: "+o),o};