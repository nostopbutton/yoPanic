<div id="designBuildView" class="container">
  <div class="container">
    <div class="row">

      <div id="view_dress_panel" class="col-md-5">
        <div class="container">
          <div class="row dress">
            <!--<div class=" pic body db-parts-sprite model-front"></div>-->
            <img ng-src="images/parts/whole body.png" class="pic body">

            <div draw-dress dress="form.design"></div>
            <div draw-trim dress="form.design"></div>
            <div draw-dress dress="form.belt"></div>
            <div draw-dress dress="form.extras"></div>
          </div>
          <div class="row purchase big-buy-button">
            <a class="btn" id="reset-design" ng-click="cancel()" ng-disabled="isCancelDisabled()"
               onClick="_gaq.push(['_trackEvent', 'Design Build', 'reset-design', '{{dress.silId}}/{{dress.itemId}}']);">Reset</a>
            <a class="btn btn-info" id="buy-big-btn" href="#/purchase"
               onClick="_gaq.push(['_trackEvent', 'Design Build', 'buy-big-btn', '{{dress.silId}}/{{dress.itemId}}']);">Buy
              Now</a>
          </div>
        </div>
      </div>

      <div id="dress_designer_panel" class="col-md-7">
        <div class="container">

          <div class="row">
            <div class="col-md-4 align-left">
              {{design.longName}}
            </div>
            <div class="col-md-4 align-center">
              <b>HKD {{design.price}}</b>
            </div>
            <div class="col-md-4 align-right">
              <a class="btn btn-mini btn-info" id="buy-sml-btn" href="#/purchase"
                 onClick="_gaq.push(['_trackEvent', 'Design Build', 'buy-sml-btn', '{{dress.silId}}/{{dress.itemId}}']);">Buy
                Now</a>
            </div>
          </div>

          <div class="row">
            <div class="top-border">
              <i>{{range.strapline}}</i>
            </div>
          </div>

          <div class="row">
            <span ng-repeat="para in range.description">{{para}}</span>
          </div>
        </div>

        <!--<ul class="nav nav-tabs" id="myTab">-->
          <!--<li class="active"><a href="#home">Home</a></li>-->
          <!--<li><a href="#profile">Profile</a></li>-->
          <!--<li><a href="#messages">Messages</a></li>-->
          <!--<li><a href="#settings">Settings</a></li>-->
        <!--</ul>-->

        <!--<div class="tab-content">-->
          <!--<div class="tab-pane active" id="home">...</div>-->
          <!--<div class="tab-pane" id="profile">...</div>-->
          <!--<div class="tab-pane" id="messages">...</div>-->
          <!--<div class="tab-pane" id="settings">...</div>-->
        <!--</div>-->

        <!--<script>-->
          <!--$(function () {-->
            <!--$('#myTab a:last').tab('show')-->
          <!--})-->
        <!--</script>-->


        <div class="row" ng-hide="isFlatDesigner">
          <div class="container">
            <div class="row">
              <div class="panel-group" id="accordian">
                <div class="panel"ng-repeat="option in range.options">
                  <div class="panel-heading">
                    <h3 class="panel-title">
                      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                        {{option.label}}
                      </a>
                    </h3>
                  </div>
                  <div id="collapseOne" class="panel-collapse collapse in"> <!--is-open="option.active">-->
                    <div class="panel-body">

                      <ul class="nav nav-tabs" id="{{option.option_name}}-tab">
                        <!--<pane class="" ng-repeat="part in option.parts" heading="{{part.label}}"-->
                              <!--active="pane.active=part.active">-->
                        <li ng-repeat="part in option.parts" class=""><a href="#{{part.label}}">{{part.label}}</a></li>  <!-- class="active" ===> active="pane.active=part.active" -->
                      </ul>

                      <div class="tab-content">
                        <div ng-repeat="part in option.parts" class="tab-pane active" id="{{part.label}}">
                          <div class="container">
                            <div class="row">
                              <div class="col-md-6">
                                <div class="" name="option_choice" data-toggle="buttons-checkbox">
                                  <!--https://github.com/angular-ui/bootstrap/issues/233-->
                                  <button ng-repeat="value in part.values" type="button" class="btn builder option"
                                          ng-model="form[option.option_name][part.part_name]['id']" btn-radio="value.id">
                                    <div class="db-icons-sprite {{part.type}}-{{value.id}}"
                                         tooltip="{{part.type}}-{{value.id}}"></div>
                                  </button>
                                </div>
                                <!--<button ng-repeat="value in option.values" type="button" class="btn builder option ng-scope ng-pristine ng-valid" ng-model="form[option.part_name]['id']" btn-radio="value.id">-->
                                <!--<div class="db-icons-sprite nek-001" tooltip="nek-001"></div>-->
                                <!--</button>-->
                                <!--<button ng-repeat="value in option.values" type="button" class="btn builder option ng-scope ng-pristine ng-valid" ng-model="form[option.part_name]['id']" btn-radio="value.id">-->
                                <!--<div class="db-icons-sprite blt-002" tooltip="blt-002"></div>-->
                                <!--</button>-->
                              </div>
                              <div class="col-md-6">
                                <!--<div fabric-selector ng-repeat="set in fabricSets | filterSets:option.fabricSets"  fabric-set="set" selected-option="form[option.part_name]"></div>-->
                                <fabric-selector ng-repeat="set in fabricSets | filterSets:part.fabricSets" fabric-set="set"
                                                 selected-option="form[option.option_name][part.part_name]"/>
                              </div>
                            </div>
                            <div class="row top-border" ng-show="part.trim">
                              <div class="col-md-6">
                                <label class="checkbox"><input type=checkbox
                                                               ng-click="clearTrim(form[option.option_name][part.part_name])"
                                                               ng-model="trim">Add trim</label>
                              </div>
                              <div class="col-md-6" ng-show="trim">
                                <!--<div fabric-selector ng-repeat="set in fabricSets | filterSets:option.fabricSets"  fabric-set="set" selected-option="form[option.part_name]"></div>-->
                                <fabric-selector ng-repeat="set in fabricSets | filterSets:part.trimFabricSets"
                                                 ng-checked="form[option.option_name][part.part_name]['trim']"
                                                 fabric-set="set" selected-option="form[option.option_name][part.part_name]"
                                                 is-trim="true"/>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>

                    </div>
                    <script>
                      $(function () {
                        $('#{{option.option_name}}- a:last').tab('show')
                      })
                    </script>
                  </div>
                </div>
              </div>


            </div>

            <div class="row">
              <accordion close-others="true">

                <accordion-group ng-repeat="option in range.options" heading="{{option.label}}" is-open="option.active">

                  <tabs class="tabbable ">
                    <pane class="" ng-repeat="part in option.parts" heading="{{part.label}}"
                          active="pane.active=part.active">

                      <div class="container">
                        <div class="row">
                          <div class="col-md-6">
                            <div class="" name="option_choice" data-toggle="buttons-checkbox">
                              <!--https://github.com/angular-ui/bootstrap/issues/233-->
                              <button ng-repeat="value in part.values" type="button" class="btn builder option"
                                      ng-model="form[option.option_name][part.part_name]['id']" btn-radio="value.id">
                                <div class="db-icons-sprite {{part.type}}-{{value.id}}"
                                     tooltip="{{part.type}}-{{value.id}}"></div>
                              </button>
                            </div>
                            <!--<button ng-repeat="value in option.values" type="button" class="btn builder option ng-scope ng-pristine ng-valid" ng-model="form[option.part_name]['id']" btn-radio="value.id">-->
                            <!--<div class="db-icons-sprite nek-001" tooltip="nek-001"></div>-->
                            <!--</button>-->
                            <!--<button ng-repeat="value in option.values" type="button" class="btn builder option ng-scope ng-pristine ng-valid" ng-model="form[option.part_name]['id']" btn-radio="value.id">-->
                            <!--<div class="db-icons-sprite blt-002" tooltip="blt-002"></div>-->
                            <!--</button>-->
                          </div>
                          <div class="col-md-6">
                            <!--<div fabric-selector ng-repeat="set in fabricSets | filterSets:option.fabricSets"  fabric-set="set" selected-option="form[option.part_name]"></div>-->
                            <fabric-selector ng-repeat="set in fabricSets | filterSets:part.fabricSets" fabric-set="set"
                                             selected-option="form[option.option_name][part.part_name]"/>
                          </div>
                        </div>
                        <div class="row top-border" ng-show="part.trim">
                          <div class="col-md-6">
                            <label class="checkbox"><input type=checkbox
                                                           ng-click="clearTrim(form[option.option_name][part.part_name])"
                                                           ng-model="trim">Add trim</label>
                          </div>
                          <div class="col-md-6" ng-show="trim">
                            <!--<div fabric-selector ng-repeat="set in fabricSets | filterSets:option.fabricSets"  fabric-set="set" selected-option="form[option.part_name]"></div>-->
                            <fabric-selector ng-repeat="set in fabricSets | filterSets:part.trimFabricSets"
                                             ng-checked="form[option.option_name][part.part_name]['trim']"
                                             fabric-set="set" selected-option="form[option.option_name][part.part_name]"
                                             is-trim="true"/>
                          </div>
                        </div>
                      </div>


                    </pane>
                  </tabs>

                </accordion-group>
              </accordion>
            </div>
          </div>
        </div>

        <div class="row" ng-show="isFlatDesigner">

          <div class="top-border" ng-repeat="option in range.options" heading="{{option.label}}"
               is-open="option.active">
            {{option.label}}
            <div class="" ng-repeat="part in option.parts" heading="{{part.label}}" active="pane.active=part.active">

              <div class="container">
                <div class="row  top-border-small">
                  {{part.label}}
                </div>
                <div class="row  top-border-small">

                  <div class="col-md-6">
                    <div class="align-center" name="option_choice" data-toggle="buttons-checkbox">
                      <!--https://github.com/angular-ui/bootstrap/issues/233-->
                      <button ng-repeat="value in part.values" type="button" class="btn builder option"
                              ng-model="form[option.option_name][part.part_name]['id']" btn-radio="value.id">
                        <div class="db-icons-sprite {{part.type}}-{{value.id}}"
                             tooltip="{{part.type}}-{{value.id}}"></div>
                      </button>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <fabric-selector ng-repeat="set in fabricSets | filterSets:part.fabricSets" fabric-set="set"
                                     selected-option="form[option.option_name][part.part_name]"/>
                  </div>
                </div>


                <div class="row top-divider " ng-show="part.trim">
                  <div class="col-md-6">
                    <label class="checkbox"><input type=checkbox
                                                   ng-click="clearTrim(form[option.option_name][part.part_name])"
                                                   ng-model="trim">Add trim</label>
                  </div>
                  <div class="col-md-6" ng-show="trim">
                    <fabric-selector ng-repeat="set in fabricSets | filterSets:part.trimFabricSets"
                                     ng-checked="form[option.option_name][part.part_name]['trim']"
                                     fabric-set="set" selected-option="form[option.option_name][part.part_name]"
                                     is-trim="true"/>
                  </div>
                </div>


              </div>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>


  <div class="row" id="debug_view">
    <div class="col-md-4 align-left">
      <a class="btn btn-mini" ng-click="isDebugCollapsed = !isDebugCollapsed">Toggle debug view</a>
    </div>
    <div class="col-md-4 align-center">
      <a class="btn btn-mini" href="#/designAdmin/{{design.desId}}">Toggle admin view</a>
    </div>
    <div class="col-md-4 align-right">
      <a class="btn btn-mini" ng-click="isFlatDesigner = !isFlatDesigner">Toggle flat designer</a>
    </div>
    <hr>
    <div collapse="isDebugCollapsed">
      <pre>form={{form}}</pre>
      <pre>fabricSets={{fabricSets}}</pre>
      <pre>trimFabricSets={{trimFabricSets}}</pre>
      <pre>dressFabricSets={{dressFabricSets}}</pre>


      <pre>master={{master}}</pre>
      <pre>category={{category}}</pre>
      <pre>design={{design}}</pre>
      <pre>range={{range}}</pre>
    </div>
  </div>
</div> <!-- /designBuildView -->