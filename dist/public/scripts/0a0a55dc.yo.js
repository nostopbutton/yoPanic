"use strict";angular.module("panicApp",["ngRoute","panicApp.Controllers","panicApp.referenceDataServices","panicApp.designBuildDirectives","panicApp.designBuildFilters","ui.bootstrap","ngSocial"]).config(function(a,b){b.hashPrefix("!"),a.when("/",{templateUrl:"/views/ng-partials/home.html",controller:"StaticPageCtrl"}).when("/fabrics",{templateUrl:"/views/ng-partials/fabrics.html",controller:"StaticPageCtrl"}).when("/party",{templateUrl:"/views/ng-partials/party.html",controller:"StaticPageCtrl"}).when("/about",{templateUrl:"/views/ng-partials/about.html",controller:"StaticPageCtrl"}).when("/terms",{templateUrl:"/views/ng-partials/terms.html",controller:"StaticPageCtrl"}).when("/privacy",{templateUrl:"/views/ng-partials/privacy.html",controller:"StaticPageCtrl"}).when("/collection",{templateUrl:"/views/ng-partials/dressCollection.html",controller:"DressCollectionCtrl"}).when("/shop/:styleId/:itemId",{templateUrl:"/views/ng-partials/shopItem.html",controller:"ShopItemCtrl"}).when("/design",{templateUrl:"/views/ng-partials/silhouettes.html",controller:"SilhouetteCtrl"}).when("/design/:styleId",{templateUrl:"/views/ng-partials/designBuild.html",controller:"NewDesignBuildCtrl"}).when("/design/:styleId/:itemId",{templateUrl:"/views/ng-partials/designBuild.html",controller:"NewDesignBuildCtrl"}).when("/review/:styleId/dress/:designCode",{templateUrl:"/views/ng-partials/idggPlaceOrder.html",controller:"NewDesignBuildCtrl"}).when("/design/:styleId/dress/:designCode",{templateUrl:"/views/ng-partials/designBuild.html",controller:"NewDesignBuildCtrl"}).otherwise({redirectTo:"/"})}),function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}();var _gaq=_gaq||[];angular.module("analytics",[]).run(["$http",function(){console.log("run analytics"),_gaq.push(["_setAccount","UA-42859790-2"]),_gaq.push(["_setDomainName","none"]);var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}]).service("analytics",function(a,b,c,d){a.$on("$viewContentLoaded",e),console.log("analytics service");var e=function(){console.log("in track");var a=f(c.path(),d);b._gaq.push(["_trackPageview",a])},f=function(a,b){for(var c in b){var d="/"+b[c];a=a.replace(d,"")}return a}}),function(a){a.deparam=function(b,c){var d={},e={"true":!0,"false":!1,"null":null};return a.each(b.replace(/\+/g," ").split("&"),function(b,f){var g,h=f.split("="),i=decodeURIComponent(h[0]),j=d,k=0,l=i.split("]["),m=l.length-1;if(/\[/.test(l[0])&&/\]$/.test(l[m])?(l[m]=l[m].replace(/\]$/,""),l=l.shift().split("[").concat(l),m=l.length-1):m=0,2===h.length)if(g=decodeURIComponent(h[1]),c&&(g=g&&!isNaN(g)?+g:"undefined"===g?void 0:void 0!==e[g]?e[g]:g),m)for(;m>=k;k++)i=""===l[k]?j.length:l[k],j=j[i]=m>k?j[i]||(l[k+1]&&isNaN(l[k+1])?{}:[]):g;else a.isArray(d[i])?d[i].push(g):d[i]=void 0!==d[i]?[d[i],g]:g;else i&&(d[i]=c?void 0:"")}),d}}(jQuery);var referenceDataServices=angular.module("panicApp.referenceDataServices",["ngResource"]);referenceDataServices.factory("Range",function(a){return a("/referenceData/:rangeId.json",{},{styleCatalogue:{method:"GET",params:{rangeId:"styleCatalogue"},isArray:!0},itemCollection:{method:"GET",params:{rangeId:"itemCollection"},isArray:!0},labelLookup:{method:"GET",params:{rangeId:"labels"},isArray:!0}})}).factory("DesignBuilder",function(a){return a("/referenceData/designBuilder/:fileId.json",{},{fabricSets:{method:"GET",params:{fileId:"fabricSets"},isArray:!0}})}).factory("MetaData",function(a){return{og_image:"http://img.aurza.com/skt-001-02-013-slv-009-00-013-nek-001-00-003-blt-002-00-000-ext-002-00-000-ext-003-00-000.png",og_title:"Sheath Dress",og_url:a.absUrl(),og_site_name:"AURZA",og_type:"dress"}}).service("CatalogueService",function(a,b,c){return{getStyleListPromise:function(){var b,d=c.defer(),e=[];return b=a.styleCatalogue(),b.$promise.then(function(a){e=_.reduce(a,function(a,b){return a.concat(b.styleId)},[]),d.resolve(e)}),d.promise},getItemCollectionPromiseForStyles:function(a){return c.all(_.map(a,function(a){return b.get({fileId:a}).$promise})).then(function(a){var b=[];return angular.forEach(a,function(a){b=b.concat(a.collection)}),b})},getItemCollectionWithStyleDataPromiseForStyles:function(a){return c.all(_.map(a,function(a){return b.get({fileId:a}).$promise})).then(function(a){var b=[];return angular.forEach(a,function(a){angular.forEach(a.collection,function(c){var d=_.extend({},c,a.style);b.push(d)})}),b})},getItemPromise:function(a,d){var e,f=c.defer(),g={itemDesign:""};return b.get({fileId:a}).$promise.then(function(a){d||(d=a.style.defaultItemId),angular.forEach(a.collection,function(a){a.itemId==d&&(g.itemDesign=angular.copy(a))}),e=_.extend({},a,g),f.resolve(e)}),f.promise;var f}}}).service("ReferenceDataCache",function(a,b){var c=null,d=null,e=null,f=null;return{getStyleCatalogue:function(){return null==c&&(c=a.styleCatalogue(),console.log("Lazy instantiation of styleCatalogue:"+c.length)),c},getLabels:function(){return console.log("getLabels"),null==d&&(d=a.labelLookup(),console.log("Lazy instantiation of labelCache:"+d.length)),d},getOptions:function(){return console.log("getOptions"),null==e&&(e=b.options(),console.log("Lazy instantiation of optionCache:"+e.length)),e},getItemCollection:function(){return null==f&&(f=a.itemCollection(function(a){console.log("----Lazy instantiation of itemCollection: "+a.length)},function(a){console.log("Oops -failed to instantiate itemCollection: "+a.length)})),f},getItemDesign:function(a){var b={},c="";return b=this.getItemCollection(function(){for(var d=0;d<b.length;d++)if(b[d].itemId===a){console.log("---Found item: "+a+" -> "+b[d].design),c=angular.copy(b[d].design);break}},function(a){console.log("Oops -failed to getItemColection: "+a.length)}),c},getStyleById:function(b,c){var d=a.styleCatalogue(function(){for(var a=0;a<d.length;a++)if(d[a].styleId===b){console.log("Found style: "+b+" -> "+d[a].styleId),c.style=angular.copy(d[a]);break}})},getItemById:function(b,c){var d=a.itemCollection(function(){for(var a=0;a<d.length;a++)if(d[a].itemId===b){console.log("Found item: "+b+" -> "+d[a].itemId),c.item=angular.copy(d[a]);break}})}}}).filter("fabricLookup",function(a){return function(b){for(var c=a.getOptions(),d="",e=0;e<c.length;e++)if(c[e].id===b){console.log("**Found options: "+b+" -> "+c[e].fabrics),d=angular.copy(c[e].fabrics);break}return d}}).filter("trimLookup",function(a){return function(b){for(var c=a.getOptions(),d="",e=0;e<c.length;e++)if(c[e].id===b){console.log("***********Found trim: "+b+" -> "+c[e].trims),d=angular.copy(c[e].trims);break}return d}}).filter("labelLookup",function(a){return function(b){for(var c=a.getLabels(),d="",e=0;e<c.length;e++)c[e].id===b&&(console.log("Found label: "+b+" -> "+c[e].label),d=angular.copy(c[e].label));return d}});var designBuildDirective=angular.module("panicApp.designBuildDirectives",[]);designBuildDirective.directive("styleOverview",function(){return{restrict:"E",scope:{styleInfo:"="},template:'<div class="container-fluid "><div class="row">    <div class="col-md-6">        <div class="name">{{styleInfo.styleName}}</div>        <div class="formal-name">{{styleInfo.styleFormalName}} </div>    </div>    <div class="col-md-6">        <div class="price-label">TOTAL</div>        <div class="price">HKD {{styleInfo.price | number:0}}</div>    </div></div><div class="row top-border" style="padding:10px 0 10px 0">    <ul>        <li class="description">{{styleInfo.strapline}}</li>        <li class="description" ng-repeat="para in styleInfo.description">{{para}}</li>    </ul></div></div>'}}),designBuildDirective.directive("drawDesign",function(){return{scope:{model:"=",design:"="},template:'<div class="db-image body sprite-body {{model}}"></div><div draw-dress parts="design.design"></div><div draw-accessories parts="design.extras"></div>'}}),designBuildDirective.directive("drawDress",function(){return{scope:{parts:"="},template:'<div ng-repeat="selection in parts"> <div class="db-image {{selection.type}} sprite-{{selection.fabric}} {{selection.type}}-{{selection.id}}-{{selection.size}}-{{selection.fabric}}"></div> <div class="db-image trm sprite-{{selection.trim}} trm-{{selection.type}}-{{selection.id}}-{{selection.size}}-{{selection.trim}}"></div></div>'}}),designBuildDirective.directive("drawAccessories",function(){return{scope:{parts:"="},template:'<div ng-repeat="selection in parts"> <div class="db-image {{selection.type}} sprite-{{selection.fabric}} {{selection.type}}-{{selection.id}}-{{selection.size}}-{{selection.fabric}}"></div></div>'}}),designBuildDirective.directive("partSelector",function(){return{restrict:"E",scope:{part:"=",selectedOption:"="},template:' <div data-toggle="buttons">  <!--https://github.com/angular-ui/bootstrap/issues/233-->  <div class="option-button" ng-repeat="value in part.values">    <button type="button" class="btn btn-default option"       ng-model="selectedOption[\'id\']" btn-radio="value.id"       ng-class="{highlight: selectedOption[\'id\']==value.id }">     <div class="db-icons-sprite {{part.type}}-{{value.id}}" ></div>   </button>  </div></div>'}}),designBuildDirective.directive("sizeSelector",function(){return{restrict:"E",scope:{part:"=",selectedOption:"="},template:'<select class="form-control input-sm" ng-model="selectedOption[\'size\']" ng-options="size.id as size.name for size in part.sizes"></select>'}}),designBuildDirective.directive("fabricSelector",function(){return{restrict:"E",scope:{fabricSet:"=",selectedOption:"=",attrib:"="},template:' <div class="fabric-group">   <div class="row fabric-header">     {{fabricSet.setName}}   </div>   <div class="row ">       <button ng-repeat="fabric in fabricSet.fabrics" type="button" class="btn fabric-selector fabric{{fabric.fabId}}"            ng-model="selectedOption[attrib]"           btn-radio="fabric.fabId"></button>   </div></div>'}}),designBuildDirective.directive("silhouette",function(){return{restrict:"A",scope:{design:"="},template:'<a href="#!/design/{{design.styleId}}"><div class="row image"><div class="col-lg-12 "> <div class="pic sprite-body {{design.silhouetteImage}}"></div></div></div><div class="row title handwriting large-hand">{{design.styleName}}</div><div class="row type handwriting">({{design.styleFormalName}})</span></div><div class="row price"><span class="glyphicon glyphicon-tags"></span>&nbsp from HKD {{design.price | number:0}}</div></a>'}});var designBuildFilter=angular.module("panicApp.designBuildFilters",[]);designBuildFilter.filter("filterSets",function(){return function(a,b){var c=[];for(var d in b)for(var e in a)if(b[d].setId==a[e].setId){c.push(a[e]);break}return c}}),designBuildFilter.filter("rollover",function(){return function(a){return a.replace(/_bk$/,"")}}),designBuildFilter.filter("designString",function(){return function(a){var b=JSON.stringify(a);return console.log("Returning---: "+b),b}}),angular.module("panicApp.Controllers",[]).run(["$http",function(){console.log("Controllers: run analytics"),_gaq.push(["_setAccount","UA-42859790-2"]),_gaq.push(["_setDomainName",".aurza.com"]);var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}]);var trackPageInGoogleAnalytics=function(a,b,c,d){a.$on("$viewContentLoaded",track(b,c,d))},track=function(a,b,c){var d=convertPathToQueryString(b.path(),c);console.log("track: about to push: "+d),a._gaq.push(["_trackPageview",d])},convertPathToQueryString=function(a,b){for(var c in b){var d="/"+b[c];a=a.replace(d,"")}for(c in b)console.log("key="+c);var e=getAsUriParameters(b);return""===e?a:a+"?"+e},getAsUriParameters=function(a){var b="";for(var c in a)b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c])+"&";return b.substring(0,b.length-1)};angular.module("panicApp.Controllers").controller("HomeCarouselCtrl",["$scope","$rootScope","$window","$location","$routeParams",function(a,b,c,d,e){trackPageInGoogleAnalytics(b,c,d,e),a.myInterval=5e3,a.slides=[{image:"images/home/Choose.png",text:"Choose..."},{image:"images/home/Customize.png",text:"Customize..."},{image:"images/home/Cherish.png",text:"Cherish!"}]}]),angular.module("panicApp.Controllers").controller("StaticPageCtrl",["$scope","$rootScope","$window","$location","$routeParams","$anchorScroll",function(a,b,c,d,e,f){trackPageInGoogleAnalytics(b,c,d,e),a.scrollTo=function(a){d.hash(a),f()}}]),angular.module("panicApp.Controllers").controller("DressCollectionCtrl",["$scope","Range","CatalogueService","$rootScope","$window","$location","$routeParams",function(a,b,c,d,e,f,g){trackPageInGoogleAnalytics(d,e,f,g);var h=c.getStyleListPromise(),i=[];h.then(function(b){i=b;var d=c.getItemCollectionWithStyleDataPromiseForStyles(["sheath","swing","flare","doloman","swoosh","shift","shirt","shirt-maxi"]);d.then(function(b){a.dresses=angular.copy(b)})}),a.silhouettes=[{id:"",label:"-- All silhouettes --"},{id:"sheath",label:"COCO (Sheath)"},{id:"swing",label:"AUDREY (Swing)"},{id:"flare",label:"ALEXA (Flare)"},{id:"doloman",label:"CHRISTINA (Doloman)"},{id:"swoosh",label:"KATE (Swoosh)"},{id:"shift",label:"EDDIE (Shift)"},{id:"shirt",label:"ELLE (Shirt)"},{id:"maxi-shirt",label:"CLAUDIA (Maxi-shirt)"}],a.types=[{id:"",label:"-- All dresses --"},{id:"dress",label:"Dress"},{id:"skirt",label:"Skirt"},{id:"top",label:"Top"}],a.colours=[{id:"",label:"-- All colours --"},{id:"red",label:"Red"},{id:"blue",label:"Blue"},{id:"black",label:"Black"}],a.silhouetteFilter=a.silhouettes[0].id,a.typeFilter=a.types[0].id,a.colourFilter=a.colours[0].id,a.reset=function(){a.silhouetteFilter=a.silhouettes[0].id,a.typeFilter=a.types[0].id,a.colourFilter=a.colours[0].id}}]),angular.module("panicApp.Controllers").controller("ShopItemCtrl",["$scope","Range","ReferenceDataCache","CatalogueService","$rootScope","$window","$location","$routeParams",function(a,b,c,d,e,f,g,h){trackPageInGoogleAnalytics(e,f,g,h),d.getItemPromise(h.styleId,h.itemId).then(function(b){a.item=angular.copy(b)}),a.sizing={size:"",bust:"",waist:"",hips:"",hollowfloor:"",height:""}}]),angular.module("panicApp.Controllers").controller("PurchaseCtrl",["$scope","Range","$rootScope","$window","$location","$routeParams",function(a,b,c,d,e,f){trackPageInGoogleAnalytics(c,d,e,f)}]),angular.module("panicApp.Controllers").controller("SilhouetteCtrl",["$scope","Range","$rootScope","$window","$location","$routeParams","$http","$q",function(a,b,c,d,e,f,g,h){a.$emit("LOAD"),trackPageInGoogleAnalytics(c,d,e,f),a.styles=b.styleCatalogue(function(){console.log("styles.length: "+a.styles.length)});var i;i=[{id:"all",label:"View all","default":!0,values:["skirt","top","dress","silk","maxi"]},{id:"separates",label:"Perfect Skirt or Top",values:["skirt","top"]},{id:"silk_dress",label:"Perfect Silk Dress",values:["silk"]},{id:"tailored_dress",label:"Perfect Tailored Dress",values:["dress"]},{id:"skirt_and_top",label:"Perfect Skirt and Top",values:["skirt","top"]},{id:"silk_maxi",label:"Perfect Silk Maxi Dress",values:["maxi"]},{id:"bundles",label:" Multi-Dress Bundles",values:["silk","maxi","dress"]},{id:"gift",label:" GIFT BOX (Voucher)",values:["silk","dress"]}],a.perkValues="",a.search=function(b){var c=!1;console.log("$scope.perkValues: "+JSON.stringify(a.perkValues)),console.log("item.type: "+JSON.stringify(b.type));for(var d=0;d<a.perkValues.length;d++)if(a.perkValues[d]==b.type){console.log("Found dress: "+b.type+" checked: "+a.perkValues[d]),c=!0;break}return c},a.reset=function(){a.perkValues=angular.copy(i[0].values),a.perks=angular.copy(i)},a.reset();var j=h.all([g.get("/images/003.png"),g.get("/images/008.png"),g.get("/images/010.png"),g.get("/images/011.png"),g.get("/images/013.png"),g.get("/images/014.png"),g.get("/images/085.png"),g.get("/images/088.png"),g.get("/images/089.png"),g.get("/images/120.png"),g.get("/images/160.png"),g.get("/images/161.png"),g.get("/images/165.png"),g.get("/images/166.png"),g.get("/images/168.png"),g.get("/images/169.png"),g.get("/images/170.png")]);j.then(function(){a.$emit("UNLOAD")})}]).controller("appController",["$scope","$location","$anchorScroll",function(a,b,c){a.headline="/how-to-help"==b.path()?"How YOU can HELP...":"Send us YOUR design",a.scrollTo=function(a){b.hash(a),c()},a.$on("LOAD",function(){a.loading=!0}),a.$on("UNLOAD",function(){a.loading=!1})}]).controller("MetaCtrl",["$scope","MetaData",function(a,b){a.data=b}]).controller("MetaCtrlInput",["$scope","MetaData",function(a,b){a.data=b}]),angular.module("panicApp.Controllers").controller("RangeDetailsCtrl",["$scope","$routeParams","Range","$rootScope","$window","$location",function(a,b,c,d,e,f){d.$on("$viewContentLoaded",track(e,f,b)),a.ranges=c.query(),a.range=c.get({rangeId:b.rangeId})}]),angular.module("panicApp.Controllers").controller("NewDesignBuildCtrl",["$scope","$routeParams","Range","ReferenceDataCache","DesignBuilder","CatalogueService","$rootScope","$window","$location",function(a,b,c,d,e,f,g,h,i){trackPageInGoogleAnalytics(g,h,i,b);var j="",k="dresses",l=b.styleId,m=(b.itemId,b.designCode),n={},o={};a.form="",a.current_title="Test",a.current_description="Test description",a.headline="test",a.tabs={style:!0,design:!1,fit:!1,order:!1},f.getItemPromise(b.styleId,b.itemId).then(function(b){a.item=angular.copy(b),_.isUndefined(m)&&(j=angular.copy(b.itemDesign.itemDesign)),o=angular.copy(b),a.master=j,a.params=$.param(j),a.cancel()}),a.isDebugCollapsed=!0,a.styleId=l,a.categoryId=k,m&&(a.designCode=m,a.deparam=angular.copy($.deparam(m)));var p=function(a){a.trim=""};a.clearTrim=p,a.dressPartCode=function(a){return console.log("SELCTION:"+a),a.type+"-"+a.id+a.length+"-"+a.fabric},a.cancel=function(){a.form=angular.copy(a.deparam?a.deparam:j)},a.fabricSets=e.fabricSets(function(b){n=angular.copy(b);for(var c in o.options)for(var d in o.options[c].fabricSets)for(var e in n)if(o.options[c].fabricSets[d].set==n[e].setId){a.range.options[c].fabricSets[d]=n[e];break}},function(){alert("ooops - loading fabrics")}),a.save=function(){j=a.form,a.cancel()},a.isCancelDisabled=function(){return angular.equals(j,a.form)},a.param=function(a){return $.param(a)},a.designString=function(a){var b=" ";console.log("I have:"+JSON.stringify(a));for(var c in a){var d="";for(var e in a[c])"$$hashKey"!=e&&(d+=e+" = "+JSON.stringify(a[c][e])+"| ");console.log(d),b+=c+" :  %0D%0A "+d+" %0D%0A "}return console.log("Returning---: "+b),b},a.designLink=function(a){var b=" ";return console.log("I have:"+JSON.stringify(a)),console.log("Returning---: "+b),b}}]);var loadStyle=function(a){var b=getCategoryById(a.ranges,a.categoryId),c=getStyleById(b.styles,a.styleId);a.category=b,a.style=c},getCategoryById=function(a,b){for(var c=[],d=0;d<a.length;d++)if(a[d].catId===b){c=angular.copy(a[d]);break}return console.log("Returning: "+c),c},getStyleById=function(a,b){for(var c={},d=0;d<a.length;d++)if(a[d].styleId===b){c=angular.copy(a[d]);break}return console.log("Returning: "+c),c},decodeDesign=function(a){$.deparam(a)},SizingCtrl=function(a){a.open=function(){a.shouldBeOpen=!0},a.close=function(){a.closeMsg="I was closed at: "+new Date,a.shouldBeOpen=!1},a.opts={backdropFade:!0,dialogFade:!0}};